#!/bin/sh

set -e

# If docker-machine exists,
# make sure the required environment variables are set for this script.
command -v docker-machine >/dev/null 2>&1 && eval $(docker-machine env default)

# Change into dev directory,
# so all following commands are run in the correct context.
USER_WORKING_DIR=$PWD
cd $(dirname $0)/..
DEVFILES_PATH=$PWD

# docker build -t graysonwright/nvim docker/nvim

docker run --rm -it \
  \
  -e HOME=$HOME \
  -e XDG_CONFIG_HOME=/config \
  \
  -v $HOME:$HOME \
  \
  -v $DEVFILES_PATH/docker/nvim/config:/config/nvim \
  -v $DEVFILES_PATH/docker/git/config:/config/git \
  \
  --workdir $USER_WORKING_DIR \
  \
  graysonwright/nvim nvim $@
